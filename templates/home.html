{% extends "base.html" %}
{% block title %}SIMLAB ‚Äî –í–∏—Ä—Ç—É–µ–ª–Ω–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—ò–∞{% endblock %}

{% block content %}
<style>
  .hero{
    background: linear-gradient(135deg,#232526,#414345);
    color:#fff;border-radius:18px;padding:22px 24px;margin-bottom:18px;
    display:flex;align-items:center;justify-content:space-between;gap:14px
  }
  .hero .kicker{opacity:.85;font-size:.95rem}
  .hero .cta-wrap{display:flex;gap:10px;flex-wrap:wrap}
  .soft{
    background:#ffffff;border-radius:16px;box-shadow:0 10px 24px rgba(0,0,0,.06);
    border:0
  }
  .feature-card .card-header{
    background:linear-gradient(135deg,#6a11cb,#2575fc);color:#fff;border:0
  }
  .feature-card .iconbox{
    width:42px;height:42px;border-radius:12px;background:#ffffff22;
    display:flex;align-items:center;justify-content:center
  }
  .muted{color:#6c757d}
  .quick{
    display:grid;grid-template-columns:repeat(3,1fr);gap:14px
  }
  @media (max-width: 992px){ .quick{grid-template-columns:1fr} }
  .pill-link{
    display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:999px;
    border:1px solid #e9ecef;background:#f8fafc;font-weight:600;text-decoration:none
  }
  .pill-link:hover{background:#eef2ff;border-color:#dfe4ff}
</style>

<!-- HERO -->
<div class="hero">
  <div>
    <div class="kicker">üß™ SIMLAB ‚Äî –í–∏—Ä—Ç—É–µ–ª–Ω–∞ —Ö–µ–º–∏—Å–∫–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—ò–∞</div>
    <h2 class="mb-1">–£—á–µ—Ç–µ, —Å–∏–º—É–ª–∏—Ä–∞—ò—Ç–µ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞—ò—Ç–µ —Ä–µ–∞–∫—Ü–∏–∏</h2>
    <div class="opacity-75">–ë–µ–∑–±–µ–¥–Ω–æ –æ–∫—Ä—É–∂–µ—ö–µ –∑–∞ —Å—Ç—É–¥–µ–Ω—Ç–∏ –∏ –ø—Ä–æ—Ñ–µ—Å–æ—Ä–∏ —Å–æ —Ä–µ–∞–ª–Ω–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏ –∏ –∏–∑–≤–µ—à—Ç–∞–∏</div>
  </div>

  <div class="cta-wrap">
    {% if is_logged %}
      <a href="/dashboard" class="btn btn-light fw-semibold">
        <i class="bi bi-speedometer2"></i> –û–¥–∏ –Ω–∞ Dashboard
      </a>
    {% else %}
      <a href="/login" class="btn btn-light fw-semibold">
        <i class="bi bi-box-arrow-in-right"></i> –ù–∞—ò–∞–≤–∞
      </a>
      <a href="/register" class="btn btn-outline-light">
        <i class="bi bi-person-plus"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞
      </a>
    {% endif %}
    <button id="db-check" class="btn btn-ghost btn-sm" style="border:1px solid #ffffff55;color:#fff">
      <i class="bi bi-activity"></i> –ü—Ä–æ–≤–µ—Ä–∏ –±–∞–∑–∞
    </button>
  </div>
</div>

<!-- –ö–õ–£–ß–ù–ò –ü–ê–¢–ï–ö–ò -->
<div class="row g-3">
  <!-- –ï–ª–µ–º–µ–Ω—Ç–∏ -->
  <div class="col-md-4">
    <div class="card soft feature-card h-100">
      <div class="card-header d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center gap-2">
          <div class="iconbox"><i class="bi bi-flask"></i></div>
          <h5 class="mb-0">–•–µ–º–∏—Å–∫–∏ –µ–ª–µ–º–µ–Ω—Ç–∏</h5>
        </div>
        {% if role == 'teacher' %}
          <a href="/elements/add" class="btn btn-light btn-sm fw-semibold"><i class="bi bi-plus-circle"></i></a>
        {% endif %}
      </div>
      <div class="card-body">
        <p class="muted">–ü—Ä–µ–ª–∏—Å—Ç–∞—ò—Ç–µ –≥–∏ –µ–ª–µ–º–µ–Ω—Ç–∏—Ç–µ –∏ –Ω–∏–≤–Ω–∏—Ç–µ —Å–≤–æ—ò—Å—Ç–≤–∞.</p>
        <a href="/elements" class="btn btn-outline-primary">
          <i class="bi bi-search"></i> –ü—Ä–µ–≥–ª–µ–¥–∞—ò –µ–ª–µ–º–µ–Ω—Ç–∏
        </a>
      </div>
    </div>
  </div>

  <!-- –û–ø—Ä–µ–º–∞ -->
  <div class="col-md-4">
    <div class="card soft feature-card h-100">
      <div class="card-header d-flex align-items-center justify-content-between" style="background:linear-gradient(135deg,#11998e,#38ef7d)">
        <div class="d-flex align-items-center gap-2">
          <div class="iconbox"><i class="bi bi-tools"></i></div>
          <h5 class="mb-0">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—Å–∫–∞ –æ–ø—Ä–µ–º–∞</h5>
        </div>
        {% if role == 'teacher' %}
          <a href="/equipment/add" class="btn btn-light btn-sm fw-semibold"><i class="bi bi-plus-circle"></i></a>
        {% endif %}
      </div>
      <div class="card-body">
        <p class="muted">–ö–∞—Ç–∞–ª–æ–≥ –Ω–∞ –æ–ø—Ä–µ–º–∞ —Å–æ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏ –Ω–∞—Å–æ–∫–∏.</p>
        <a href="/equipment" class="btn btn-outline-success">
          <i class="bi bi-wrench"></i> –ü—Ä–µ–≥–ª–µ–¥–∞—ò –æ–ø—Ä–µ–º–∞
        </a>
      </div>
    </div>
  </div>

  <!-- –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—ò–∞ -->
  <div class="col-md-4">
    <div class="card soft feature-card h-100">
      <div class="card-header d-flex align-items-center justify-content-between" style="background:linear-gradient(135deg,#ee0979,#ff6a00)">
        <div class="d-flex align-items-center gap-2">
          <div class="iconbox"><i class="bi bi-radioactive"></i></div>
          <h5 class="mb-0">–í–∏—Ä—Ç—É–µ–ª–Ω–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—ò–∞</h5>
        </div>
      </div>
      <div class="card-body">
        <p class="muted">–°–∏–º—É–ª–∏—Ä–∞—ò —Ä–µ–∞–∫—Ü–∏–∏ —Å–æ drag-and-drop –∏ –µ–≤–∏–¥–µ–Ω—Ç–∏—Ä–∞—ò –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏.</p>
        <a href="/laboratory" class="btn btn-outline-danger">
          <i class="bi bi-flask"></i> –û—Ç–≤–æ—Ä–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—ò–∞
        </a>
      </div>
    </div>
  </div>
</div>

<!-- –ë—Ä–∑–∏ –≤—Ä—Å–∫–∏ / –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ —É–ª–æ–≥–∞ -->
<div class="card soft mt-3">
  <div class="card-body">
    <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
      <div class="fw-bold"><i class="bi bi-lightning"></i> –ë—Ä–∑–∏ –≤—Ä—Å–∫–∏</div>
      <div class="quick">
        {% if role == 'teacher' %}
          <a class="pill-link" href="/reactions"><i class="bi bi-diagram-3"></i> –†–µ–∞–∫—Ü–∏–∏</a>
          <a class="pill-link" href="/reports"><i class="bi bi-bar-chart"></i> –ò–∑–≤–µ—à—Ç–∞–∏</a>
          <a class="pill-link" href="/my_students"><i class="bi bi-people"></i> –ú–æ–∏ —Å—Ç—É–¥–µ–Ω—Ç–∏</a>
        {% elif role == 'student' %}
          <a class="pill-link" href="/my-experiments"><i class="bi bi-journal-text"></i> –ú–æ–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏</a>
          <a class="pill-link" href="/elements"><i class="bi bi-flask"></i> –ï–ª–µ–º–µ–Ω—Ç–∏</a>
          <a class="pill-link" href="/laboratory"><i class="bi bi-radioactive"></i> –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—ò–∞</a>
        {% else %}
          <a class="pill-link" href="/elements"><i class="bi bi-flask"></i> –ï–ª–µ–º–µ–Ω—Ç–∏</a>
          <a class="pill-link" href="/equipment"><i class="bi bi-tools"></i> –û–ø—Ä–µ–º–∞</a>
          <a class="pill-link" href="/reports"><i class="bi bi-bar-chart"></i> –ò–∑–≤–µ—à—Ç–∞–∏</a>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<!-- –ò–Ω—Ñ–æ —Å–µ–∫—Ü–∏—ò–∞ -->
<div class="row g-3 mt-3">
  <div class="col-lg-7">
    <div class="card soft">
      <div class="card-body">
        <h5 class="mb-2"><i class="bi bi-info-circle"></i> –®—Ç–æ –Ω—É–¥–∏ SIMLAB?</h5>
        <ul class="mb-0 muted">
          <li>–ö–∞—Ç–∞–ª–æ–≥ –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∏ –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—Å–∫–∞ –æ–ø—Ä–µ–º–∞.</li>
          <li>–í–∏–∑—É–µ–ª–Ω–∞ —Å–∏–º—É–ª–∞—Ü–∏—ò–∞ –Ω–∞ —Ä–µ–∞–∫—Ü–∏–∏ —Å–æ –µ–≤–∏–¥–µ–Ω—Ü–∏—ò–∞ –Ω–∞ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏.</li>
          <li>–ò–∑–≤–µ—à—Ç–∞–∏ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç/–æ–ø—Ä–µ–º–∞/–ø–æ–ø—É–ª–∞—Ä–Ω–æ—Å—Ç –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∏.</li>
          <li>–†–∞–∑–ª–∏—á–Ω–∏ —É–ª–æ–≥–∏: –ø—Ä–æ—Ñ–µ—Å–æ—Ä/—Å—Ç—É–¥–µ–Ω—Ç —Å–æ –ø—Ä–∏–ª–∞–≥–æ–¥–µ–Ω–∏ –∞–ª–∞—Ç–∫–∏.</li>
        </ul>
      </div>
    </div>
  </div>
  <div class="col-lg-5">
    <div class="card soft">
      <div class="card-body">
        <h6 class="mb-2"><i class="bi bi-broadcast-pin"></i> –°–æ—Å—Ç–æ—ò–±–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º</h6>
        <div id="db-status" class="small muted">–ë–∞–∑–∞—Ç–∞: <em>–Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ</em></div>
        <div id="db-msg" class="mt-2"></div>
      </div>
    </div>
  </div>
</div>

<script>
  // –õ–µ—Å–µ–Ω health-check –∫–æ–Ω /test-db (–∏—Å—Ç–∏–æ—Ç —à—Ç–æ –≤–µ—ú–µ –≥–æ –∏–º–∞—à)
  const btn = document.getElementById('db-check');
  const status = document.getElementById('db-status');
  const msg = document.getElementById('db-msg');
  if(btn){
    btn.addEventListener('click', async () => {
      btn.disabled = true; btn.innerHTML = '<i class="bi bi-hourglass-split"></i> –ü—Ä–æ–≤–µ—Ä—É–≤–∞–º...';
      try{
        const res = await fetch('/test-db');
        const data = await res.json();
        if(data.status === 'success'){
          status.innerHTML = '–ë–∞–∑–∞—Ç–∞: <span class="text-success fw-semibold">–æ–Ω–ª–∞—ò–Ω</span>';
          msg.innerHTML = '<div class="alert alert-success py-2 my-2"><i class="bi bi-check-circle"></i> ' + (data.message||'') + '</div>';
        }else{
          status.innerHTML = '–ë–∞–∑–∞—Ç–∞: <span class="text-danger fw-semibold">–ø—Ä–æ–±–ª–µ–º</span>';
          msg.innerHTML = '<div class="alert alert-danger py-2 my-2"><i class="bi bi-x-octagon"></i> ' + (data.message||'') + '</div>';
        }
      }catch(e){
        status.innerHTML = '–ë–∞–∑–∞—Ç–∞: <span class="text-danger fw-semibold">–Ω–µ–¥–æ—Å—Ç–∞–ø–Ω–∞</span>';
        msg.innerHTML = '<div class="alert alert-danger py-2 my-2">–ò—Å–∫–ª—É—á–æ–∫: ' + e + '</div>';
      }finally{
        btn.disabled = false; btn.innerHTML = '<i class="bi bi-activity"></i> –ü—Ä–æ–≤–µ—Ä–∏ –±–∞–∑–∞';
      }
    });
  }
</script>
{% endblock %}
